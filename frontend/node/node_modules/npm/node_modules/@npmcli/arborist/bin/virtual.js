const Arborist = require('@npmcli/arborist')

const printTree = require('@npmcli/arborist/bin/lib/print-tree.js')

module.exports = (options, time) => new Arborist(options)
  .loadVirtual()
  .then(time)
  .then(async ({ timing, result: tree }) => {
    printTree(tree)
    if (options.save) {
      await tree.meta.save()
    }
    return `read ${tree.inventory.size} deps in ${timing.ms}`
  })
